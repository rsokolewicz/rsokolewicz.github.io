<!doctype html><html lang=en><head><title>A derivation of the Kubo formula :: Roberts blog</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A short derivation of linear response formulas from a Keldysh-framework."><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://rsokolewicz.github.io/physics/4_kubo/><link rel=stylesheet href=https://rsokolewicz.github.io/assets/style.css><link rel=stylesheet href=https://rsokolewicz.github.io/assets/css/style.css><link rel=stylesheet href=https://rsokolewicz.github.io/assets/css/hugo-cite.css><link rel=apple-touch-icon href=https://rsokolewicz.github.io/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=https://rsokolewicz.github.io/img/favicon/orange.png><meta name=twitter:card content="summary"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="A derivation of the Kubo formula"><meta property="og:description" content="A short derivation of linear response formulas from a Keldysh-framework."><meta property="og:url" content="https://rsokolewicz.github.io/physics/4_kubo/"><meta property="og:site_name" content="Roberts blog"><meta property="og:image" content="https://rsokolewicz.github.io/img/favicon/orange.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2023-01-01 00:00:00 +0000 UTC"><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],macros:{bb:["{\\boldsymbol{#1}}",1],tr:"{\\DeclareMathOperator{\\tr}{Tr}}",im:"{\\DeclareMathOperator{\\im}{Im}}",re:`{\\DeclareMathOperator{\\re}{Re}}`},processEscapes:!0,processEnvironments:!0,tags:"ams"},options:{skipHtmlTags:["script","noscript","style","textarea","pre"]}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></head><body class=orange><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>Home</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/about>About</a></li><li><a href=/cv>CV</a></li><li><a href=/physics>Physics</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/about>About</a></li><li><a href=/cv>CV</a></li><li><a href=/physics>Physics</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=https://rsokolewicz.github.io/physics/4_kubo/>A derivation of the Kubo formula</a></h1><div class=post-meta><span class=post-date>2023-01-01</span>
<span class=post-author>:: Robert</span></div><div class=post-content><div><p>The linear response formula we used to compute the spin-density of conducting electrons can be obtained in a Keldysh-framework. We start by introducing the Green function $\mathcal{G}$ in rotated Keldysh space [see e.g.
<span class=hugo-cite-intext itemprop=citation>(<span class=hugo-cite-group>
<a href=#rammer_quantum_1986><span class=visually-hidden>Citation: </span><span itemprop=author itemscope itemtype=https://schema.org/Person><meta itemprop=givenName content="J."><span itemprop=familyName>Rammer</span></span>
<em>& al.</em>, <span itemprop=datePublished>1986</span></a><span class=hugo-cite-citation>
<span itemscope itemtype=https://schema.org/Article data-type=article><span itemprop=author itemscope itemtype=https://schema.org/Person><span itemprop=familyName>Rammer</span>, <meta itemprop=givenName content="J.">J.</span> & <span itemprop=author itemscope itemtype=https://schema.org/Person><span itemprop=familyName>Smith</span>, <meta itemprop=givenName content="H.">H.</span>
 
(<span itemprop=datePublished>1986</span>).
 <span itemprop=name>Quantum field-theoretical methods in transport theory of metals</span>.<i>
<span itemprop=about>Rev. Mod. Phys.</span>, 58(2)</i>. <span itemprop=pagination>323–359</span>.
<a href=https://doi.org/10.1103/revmodphys.58.323 itemprop=identifier itemtype=https://schema.org/URL>https://doi.org/10.1103/revmodphys.58.323</a></span>
</span></span>)</span>]</p><p>$$\mathcal{G}=\begin{pmatrix}G^\text{R} & G^\text{K}\\
0 & G^\text{A}\end{pmatrix}$$</p><p>where R, A and K denote retarded, advanced and Keldysh Green functions respectively. In this notation a perturbation to a classical field $V(\bb{x},t)$ is given by
$$\begin{multline}
\delta\mathcal{G}(\bb{x}_1,t_1;\bb{x}_2,t_2)=\int\!d\bb{x}_3\int\!dt_3\, \mathcal{G}^{(0)}(\bb{x}_1,t_1;\bb{x}_3,t_3)\
\hat{V}(\bb{x}_3,t_3)\mathcal{G}^{(0)}(\bb{x}_3,t_3;\bb{x}_2,t_2)+\mathcal{O}(V^2)
\label{chap1:eq:s2}
\end{multline}$$</p><p>with $\mathcal{G}^{(0)}$ equilibrium Green functions. The Wigner-transform of a function $F(\bb{x}_1,t_1;\bb{x}_2,t_2)$ is given by</p><p>$$\begin{multline}
F(\bb{x}_1,t_1;\bb{x}_2,t_2)=\int\frac{d^2\bb{p}}{(2\pi\hslash)^2}\int \frac{d\varepsilon}{2\pi\hslash}\,e^{-i\varepsilon(t_1-t_2)/\hslash}e^{i\bb{p}\cdot(\bb{x}_1-\bb{x}_2)/\hslash}F(\varepsilon,\bb{p},R,T)
\end{multline}$$</p><p>with energy $\varepsilon$, momentum $\bb{p}$, time $T=\frac{t_1+t_2}{2}$ and position $\bb{R}=\frac{\bb{x}_1+\bb{x}_2}{2}$. In equilibrium the Green functions $\mathcal{G}^{(0)}$ do not depend on $\bb{R}$ and $T$, so that the momentum-frequency representation of Eq.(\ref{chap1:eq:s2}) becomes</p><p>$$\delta\mathcal{G}(\varepsilon,\omega,\bb{p},\bb{q})= \mathcal{G}^{(0)}_{\varepsilon_+,\bb{p}_+} V_{\omega,\bb{q}}\mathcal{G}^{{(0)}}_{\varepsilon_-,\bb{q}_-},$$</p><p>with subscripts $\varepsilon_\pm=\varepsilon\pm\hslash\omega/2$ and $\bb{p}<em>\pm=\bb{p}\pm\hslash\bb{q}/2$ and $V</em>{\omega,\bb{q}}$ the Fourier transform of $V(\bb{R},T)$.</p><p>The spin density $\bb{s}_{\omega,\bb{q}}$ is given by</p><p>$$\bb{s}_{\omega,\bb{q}} = {i\hslash} \int\!\frac{d\varepsilon}{2\pi\hslash}\int\!\frac{d^2\bb{p}}{(2\pi\hslash)^2}\tr \left[\delta G^&lt;({\varepsilon,\omega,\bb{p},\bb{q}},T) \bb{\sigma}\right],
$$</p><p>where,</p><p>$$\delta G^&lt;(\varepsilon,\omega,\bb{p},\bb{q}) = 1/2 \big(\delta G^\text{K}(\varepsilon,\omega,\bb{p},\bb{q})-
\delta G^\text{R}(\varepsilon,\omega,\bb{p},\bb{q})+\delta G^\text{A}(\varepsilon,\omega,\bb{p},\bb{q})\big),<br>$$</p><p>and $\bb{\sigma}$ is a vector of spin operators. For a ferromagnet $\sigma$ are the usual Pauli-matrices acting on spin-degree of freedom, whereas for the antiferromagnet we use $\bb{\sigma},\Sigma_{0,z}\Lambda_{0,z}$ for the (non)-staggered spin-densities $\bb{s}^\pm$. Here $\Sigma$ and $\Lambda$ are the usual Pauli-matrices acting on sublattice and valley space degree of freedom respectively.</p><p>In equilibrium we have the fluctuation-dissipation theorem $G^\text{K}_{\varepsilon_\pm,\bb{p}_\pm} = (1-2f_{\varepsilon_\pm})(G^\text{R}_{\varepsilon_\pm,\bb{p}_\pm}-G^\text{A}_{\varepsilon_\pm,\bb{p}_\pm}) $ with $f_{\varepsilon_\pm}$ the Fermi distribution, so that the spin density now becomes</p><p>$$\begin{multline}
\bb{s}<em>{\omega,\bb{q}} = {i\hslash} \int\!\frac{d\varepsilon}{2\pi\hslash}\int\!\frac{d^2\bb{p}}{(2\pi\hslash)^2}\tr\langle
-(f_{\varepsilon_+}-f_{\varepsilon_-})\bb{\sigma}G^\text{R}_{\varepsilon_+,\bb{p}_+} V_{\omega,\bb{q}}G^\text{A}_{\varepsilon_-,\bb{p}_-}\\
-f_{\varepsilon</em>+}\bb{\sigma}G^\text{R}_{\varepsilon_+,\bb{p}_+} V_{\omega,\bb{q}}G^\text{R}_{\varepsilon_-,\bb{p}_-}
+f_{\varepsilon_-}\bb{\sigma}G^\text{A}_{\varepsilon_+,\bb{p}_+} V_{\omega,\bb{q}}G^\text{A}_{\varepsilon_-,\bb{p}_-}\rangle,
\end{multline}$$</p><p>where the angular brackets stands for impurity averaging. The latter amounts to the replacement of the Green&rsquo;s functions with the corresponding impurity averaged Greens functions (in Born approximation) and to the replacement of one of the spin operators with the corresponding vertex corrected operator (in the non-crossing approximation). The corrections beyond the non-crossing approximation are important for those tensor components that lack leading-order contribution
<span class=hugo-cite-intext itemprop=citation>(<span class=hugo-cite-group>
<a href=#ivan><span class=visually-hidden>Citation: </span><span itemprop=author itemscope itemtype=https://schema.org/Person><meta itemprop=givenName content="I. A."><span itemprop=familyName>Ado</span></span> 
<em>& al.</em>, <span itemprop=datePublished>2015</span></a><span class=hugo-cite-citation>
<span itemscope itemtype=https://schema.org/Article data-type=article><span itemprop=author itemscope itemtype=https://schema.org/Person><span itemprop=familyName>Ado</span>, <meta itemprop=givenName content="I. A.">I.</span>, 
<span itemprop=author itemscope itemtype=https://schema.org/Person><span itemprop=familyName>Dmitriev</span>, <meta itemprop=givenName content="I. A.">I.</span>, 
<span itemprop=author itemscope itemtype=https://schema.org/Person><span itemprop=familyName>Ostrovsky</span>, <meta itemprop=givenName content="P. M.">P.</span> & <span itemprop=author itemscope itemtype=https://schema.org/Person><span itemprop=familyName>Titov</span>, <meta itemprop=givenName content="M.">M.</span>
 
(<span itemprop=datePublished>2015</span>).
 <span itemprop=name>Anomalous hall effect with massive Dirac fermions</span>.<i>
<span itemprop=about>EPL</span>, 111(3)</i>. <span itemprop=pagination>37004</span>.
<a href=https://doi.org/10.1209/0295-5075/111/37004 itemprop=identifier itemtype=https://schema.org/URL>https://doi.org/10.1209/0295-5075/111/37004</a></span>
</span></span>)</span>. To keep our notations more compact we ignore here the fact that the Green&rsquo;s functions before disorder averaging lack translational invariance, i.e. depend on both Wigner coordinates: momentum and coordinate.</p><p>In the limit of small frequency, i.e. $\hslash\omega\ll\varepsilon$, we obtain $s_\alpha = s^\text{I}<em>\alpha+s^\text{II}</em>\alpha$,
$$\begin{align}
s^\text{I}<em>\alpha & =\frac{i\omega}{2\hslash}\int\frac{d\varepsilon}{2\pi}\int \frac{d^2\bb{p}}{(2\pi)^2}\Big(-\frac{\partial f}{\partial \varepsilon}\Big)\tr\big\langle
2\sigma</em>\alpha G^\text{R}<em>{\varepsilon</em>+,\bb{p}<em>+} V</em>{\omega,\bb{q}} G^\text{A}<em>{\varepsilon</em>-,\bb{p}<em>-}
\nonumber\\
& \hspace{3cm}-\sigma</em>\alpha G^\text{A}<em>{\varepsilon</em>+,\bb{p}<em>+} V</em>{\omega,\bb{q}} G^\text{A}<em>{\varepsilon</em>-,\bb{p}<em>-} -\sigma</em>\alpha G^\text{R}<em>{\varepsilon</em>+,\bb{p}<em>+} V</em>{\omega,\bb{q}} G^\text{R}<em>{\varepsilon</em>-,\bb{p}<em>-}\big\rangle,\\
s^\text{II}</em>\alpha & =\frac{i}{\hslash}\int\frac{d\varepsilon}{2\pi}\int \frac{d^2\bb{p}}{(2\pi)^2} f_\varepsilon \tr \big\langle\sigma_\alpha
G^\text{A}<em>{\varepsilon</em>+,\bb{p}<em>+} V</em>{\omega,\bb{q}} G^\text{A}<em>{\varepsilon</em>-,\bb{p}<em>-}-
\sigma</em>\alpha G^\text{R}<em>{\varepsilon</em>+,\bb{p}<em>+} V</em>{\omega,\bb{q}} G^\text{R}<em>{\varepsilon</em>-,\bb{p}_-}\big\rangle,
\end{align}$$</p><p>where $s^{\text{I}}$ and $s^\text{II}$ are the Kubo and Středa contributions respectively. The Středa contribution is sub-leading in the powers of weak disorder strength $\alpha\ll 1$ as long as the Fermi energy lies outside the gap. Similarly, the AA and RR bubbles in the expression of $s_\alpha^\text{I}$ are sub-leading and may be neglected. Furthermore, we work in the zero temperature limit.</p><p>The linear response to electric field and time derivative of magnetization corresponds to $V_{\bb{q},\omega} = -\hat{\bb{j}}
\cdot\bb{A}-\Delta_\text{sd} \bb{m}\cdot\bb{\sigma}$, so that we obtain</p><p>$$\begin{equation}
\bb{s}_{\bb{q},\omega}=\frac{1}{v^2h}\hat{K}(\bb{q},\omega)[ev(\bb{E}_{\bb{q},\omega}\times\hat{\bb{z}})-i\omega\Delta_{\text{sd}}\bb{m}_{\omega}],
\label{chap1:eq:skubo}
\end{equation}$$</p><p>where the components of the tensor $\hat{K}$ are given by</p><p>$$\begin{equation}
\hat{K}_{\alpha\beta}(\bb{q},\omega)={v^2}\int\!\frac{d^2\bb{p}}{(2\pi)^2}\tr \langle \sigma_\alpha G^\text{R}_{\bb{p}+ \hslash q,\varepsilon+\hslash\omega}\sigma_\beta G^\text{A}_{\bb{p},\varepsilon}\rangle.
\label{chap1:eq:skuboB}
\end{equation}$$</p></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2023 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=https://rsokolewicz.github.io/assets/main.js></script>
<script src=https://rsokolewicz.github.io/assets/prism.js></script></div></body></html>