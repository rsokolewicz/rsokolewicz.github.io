<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>A derivation of the Kubo formula :: Roberts blog</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="A short derivation of linear response formulas from a Keldysh-framework." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://rsokolewicz.github.io/physics/4_kubo/" />




<link rel="stylesheet" href="https://rsokolewicz.github.io/assets/style.css">



<link rel="stylesheet" href="https://rsokolewicz.github.io/assets/css/style.css">
<link rel="stylesheet" href="https://rsokolewicz.github.io/assets/css/hugo-cite.css">


<link rel="apple-touch-icon" href="https://rsokolewicz.github.io/img/apple-touch-icon-192x192.png">

  <link rel="shortcut icon" href="https://rsokolewicz.github.io/img/favicon/orange.png">



<meta name="twitter:card" content="summary" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="A derivation of the Kubo formula">
<meta property="og:description" content="A short derivation of linear response formulas from a Keldysh-framework." />
<meta property="og:url" content="https://rsokolewicz.github.io/physics/4_kubo/" />
<meta property="og:site_name" content="Roberts blog" />

  
    <meta property="og:image" content="https://rsokolewicz.github.io/img/favicon/orange.png">
  

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">


  <meta property="article:published_time" content="2023-01-01 00:00:00 &#43;0000 UTC" />













<script>
    MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']],
            displayMath: [['$$', '$$'], ['\\[', '\\]']],
            macros: {
                bb: ["{\\boldsymbol{#1}}", 1],
                tr: "{\\DeclareMathOperator{\\tr}{Tr}}",
                im: "{\\DeclareMathOperator{\\im}{Im}}",
                re: "{\\DeclareMathOperator{\\re}{Re}}",

                
                
                
                
                
                
                
                
                
                
            },
            processEscapes: true,
            processEnvironments: true,
            tags: "ams"
        },
        options: {
            skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
        }
    };

    window.addEventListener('load', (event) => {
        document.querySelectorAll("mjx-container").forEach(function (x) {
            x.parentElement.classList += 'has-jax'
        })
    });

</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript" id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        // Fix <code> tags after MathJax finishes running. This is a
        // hack to overcome a shortcoming of Markdown. Discussion at
        // https://github.com/mojombo/jekyll/issues/199
        var all = MathJax.Hub.getAllJax(), i;
        for(i = 0; i &lt; all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
    </script>


</head>
<body class="orange">


<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    Home
  </div>
</a>

    </div>
    
      <div class="menu-trigger">menu</div>
    
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/books">Book Reviews</a></li>
        
      
        
          <li><a href="/cv">CV</a></li>
        
      
        
          <li><a href="/physics">Physics</a></li>
        
      
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
      
        <li><a href="/books">Book Reviews</a></li>
      
    
      
        <li><a href="/cv">CV</a></li>
      
    
      
        <li><a href="/physics">Physics</a></li>
      
    
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="https://rsokolewicz.github.io/physics/4_kubo/">A derivation of the Kubo formula</a></h1>
  <div class="post-meta">
    
      <span class="post-date">
        2023-01-01
        
      </span>
    
    
      <span class="post-author">:: Robert</span>
    
    
  </div>

  
  


  

  <div class="post-content"><div>
        <p>The linear response formula we used to compute the spin-density of conducting electrons can be obtained in a Keldysh-framework. We start by introducing the Green function <code>$\mathcal{G}$</code> in rotated Keldysh space [see e.g. 




<span class="hugo-cite-intext"
        itemprop="citation">(<span class="hugo-cite-group">

          <a href="#rammer_quantum_1986"><span class="visually-hidden">Citation: </span><span itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="givenName" content="J."><span itemprop="familyName">Rammer</span></span>
                  <em>&amp; al.</em>,&#32;<span itemprop="datePublished">1986</span></a><span class="hugo-cite-citation"> 










<span itemscope
      itemtype="https://schema.org/Article"
      data-type="article"><span itemprop="author" itemscope itemtype="https://schema.org/Person"><span itemprop="familyName">Rammer</span>,&#32;
    <meta itemprop="givenName" content="J." />
    J.</span>&#32;&amp;&#32;<span itemprop="author" itemscope itemtype="https://schema.org/Person"><span itemprop="familyName">Smith</span>,&#32;
    <meta itemprop="givenName" content="H." />
    H.</span>
  &#32;
    (<span itemprop="datePublished">1986</span>).
  &#32;<span itemprop="name">Quantum field-theoretical methods in transport theory of metals</span>.<i>
    <span itemprop="about">Rev. Mod. Phys.</span>,&#32;58(2)</i>.&#32;<span itemprop="pagination">323–359</span>.
  <a href="https://doi.org/10.1103/revmodphys.58.323"
     itemprop="identifier"
     itemtype="https://schema.org/URL">https://doi.org/10.1103/revmodphys.58.323</a></span>




</span></span>)</span>]</p>
<div>$$\mathcal{G}=\begin{pmatrix}G^\text{R} & G^\text{K}\\
0 & G^\text{A}\end{pmatrix}$$</div>
<p>where R, A and K denote retarded, advanced and Keldysh Green functions respectively. In this notation a perturbation to a classical field <code>$V(\bb{x},t)$</code> is given by</p>
<div>$$\begin{multline}
    \delta\mathcal{G}(\bb{x}_1,t_1;\bb{x}_2,t_2)=\int\!d\bb{x}_3\int\!dt_3\, \mathcal{G}^{(0)}(\bb{x}_1,t_1;\bb{x}_3,t_3)\
    \hat{V}(\bb{x}_3,t_3)\mathcal{G}^{(0)}(\bb{x}_3,t_3;\bb{x}_2,t_2)+\mathcal{O}(V^2)
    \label{chap1:eq:s2}
\end{multline}$$</div>
<p>with <code>$\mathcal{G}^{(0)}$</code> equilibrium Green functions. The Wigner-transform of a function <code>$F(\bb{x}_1,t_1;\bb{x}_2,t_2)$</code> is given by</p>
<div>$$\begin{multline}
    F(\bb{x}_1,t_1;\bb{x}_2,t_2)=\int\frac{d^2\bb{p}}{(2\pi\hslash)^2}\int \frac{d\varepsilon}{2\pi\hslash}\,e^{-i\varepsilon(t_1-t_2)/\hslash}e^{i\bb{p}\cdot(\bb{x}_1-\bb{x}_2)/\hslash}F(\varepsilon,\bb{p},R,T)
   \end{multline}$$</div>
<p>with energy <code>$\varepsilon$</code>, momentum <code>$\bb{p}$</code>, time <code>$T=\frac{t_1+t_2}{2}$</code> and position <code>$\bb{R}=\frac{\bb{x}_1+\bb{x}_2}{2}$</code>. In equilibrium the Green functions <code>$\mathcal{G}^{(0)}$</code> do not depend on <code>$\bb{R}$</code> and <code>$T$</code>, so that the momentum-frequency representation of Eq.(\ref{chap1:eq:s2}) becomes</p>
<div>$$\delta\mathcal{G}(\varepsilon,\omega,\bb{p},\bb{q})= \mathcal{G}^{(0)}_{\varepsilon_+,\bb{p}_+} V_{\omega,\bb{q}}\mathcal{G}^{{(0)}}_{\varepsilon_-,\bb{q}_-},$$</div>
<p>with subscripts <code>$\varepsilon_\pm=\varepsilon\pm\hslash\omega/2$</code> and <code>$\bb{p}_\pm=\bb{p}\pm\hslash\bb{q}/2$</code> and <code>$V_{\omega,\bb{q}}$</code> the Fourier transform of <code>$V(\bb{R},T)$</code>.</p>
<p>The spin density <code>$\bb{s}_{\omega,\bb{q}}$</code> is given by</p>
<div>$$\bb{s}_{\omega,\bb{q}} = {i\hslash} \int\!\frac{d\varepsilon}{2\pi\hslash}\int\!\frac{d^2\bb{p}}{(2\pi\hslash)^2}\tr \left[\delta G^<({\varepsilon,\omega,\bb{p},\bb{q}},T) \bb{\sigma}\right],$$</div>
<p>where,</p>
<div>$$\delta G^<(\varepsilon,\omega,\bb{p},\bb{q}) = 1/2 \big(\delta G^\text{K}(\varepsilon,\omega,\bb{p},\bb{q})-
    \delta G^\text{R}(\varepsilon,\omega,\bb{p},\bb{q})+\delta G^\text{A}(\varepsilon,\omega,\bb{p},\bb{q})\big),$$</div>
<p>and <code>$\bb{\sigma}$</code> is a vector of spin operators. For a ferromagnet <code>$\sigma$</code> are the usual Pauli-matrices acting on spin-degree of freedom, whereas for the antiferromagnet we use <code>$\bb{\sigma}\,\Sigma_{0,z}\Lambda_{0,z}$</code> for the (non)-staggered spin-densities <code>$\bb{s}^\pm$</code>. Here <code>$\Sigma$</code> and <code>$\Lambda$</code> are the usual Pauli-matrices acting on sublattice and valley space degree of freedom respectively.</p>
<p>In equilibrium we have the fluctuation-dissipation theorem <code>$G^\text{K}_{\varepsilon_\pm,\bb{p}_\pm} = (1-2f_{\varepsilon_\pm})(G^\text{R}_{\varepsilon_\pm,\bb{p}_\pm}-G^\text{A}_{\varepsilon_\pm,\bb{p}_\pm}) $</code> with <code>$f_{\varepsilon_\pm}$</code> the Fermi distribution, so that the spin density now becomes</p>
<div>$$\begin{multline}
    \bb{s}_{\omega,\bb{q}} =   {i\hslash} \int\!\frac{d\varepsilon}{2\pi\hslash}\int\!\frac{d^2\bb{p}}{(2\pi\hslash)^2}\tr\langle
     -(f_{\varepsilon_+}-f_{\varepsilon_-})\bb{\sigma}G^\text{R}_{\varepsilon_+,\bb{p}_+} V_{\omega,\bb{q}}G^\text{A}_{\varepsilon_-,\bb{p}_-}\\
     -f_{\varepsilon_+}\bb{\sigma}G^\text{R}_{\varepsilon_+,\bb{p}_+} V_{\omega,\bb{q}}G^\text{R}_{\varepsilon_-,\bb{p}_-}
    +f_{\varepsilon_-}\bb{\sigma}G^\text{A}_{\varepsilon_+,\bb{p}_+} V_{\omega,\bb{q}}G^\text{A}_{\varepsilon_-,\bb{p}_-}\rangle,
\end{multline}$$</div>
<p>where the angular brackets stands for impurity averaging. The latter amounts to the replacement of the Green&rsquo;s functions with the corresponding impurity averaged Greens functions (in Born approximation) and to the replacement of one of the spin operators with the corresponding vertex corrected operator (in the non-crossing approximation). The corrections beyond the non-crossing approximation are important for those tensor components that lack leading-order contribution 




<span class="hugo-cite-intext"
        itemprop="citation">(<span class="hugo-cite-group">

          <a href="#ivan"><span class="visually-hidden">Citation: </span><span itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="givenName" content="I. A."><span itemprop="familyName">Ado</span></span>&#32;
                  <em>&amp; al.</em>,&#32;<span itemprop="datePublished">2015</span></a><span class="hugo-cite-citation"> 










<span itemscope
      itemtype="https://schema.org/Article"
      data-type="article"><span itemprop="author" itemscope itemtype="https://schema.org/Person"><span itemprop="familyName">Ado</span>,&#32;
    <meta itemprop="givenName" content="I. A." />
    I.</span>,&#32;
  <span itemprop="author" itemscope itemtype="https://schema.org/Person"><span itemprop="familyName">Dmitriev</span>,&#32;
    <meta itemprop="givenName" content="I. A." />
    I.</span>,&#32;
  <span itemprop="author" itemscope itemtype="https://schema.org/Person"><span itemprop="familyName">Ostrovsky</span>,&#32;
    <meta itemprop="givenName" content="P. M." />
    P.</span>&#32;&amp;&#32;<span itemprop="author" itemscope itemtype="https://schema.org/Person"><span itemprop="familyName">Titov</span>,&#32;
    <meta itemprop="givenName" content="M." />
    M.</span>
  &#32;
    (<span itemprop="datePublished">2015</span>).
  &#32;<span itemprop="name">Anomalous hall effect with massive Dirac fermions</span>.<i>
    <span itemprop="about">EPL</span>,&#32;111(3)</i>.&#32;<span itemprop="pagination">37004</span>.
  <a href="https://doi.org/10.1209/0295-5075/111/37004"
     itemprop="identifier"
     itemtype="https://schema.org/URL">https://doi.org/10.1209/0295-5075/111/37004</a></span>




</span></span>)</span>. To keep our notations more compact we ignore here the fact that the Green&rsquo;s functions before disorder averaging lack translational invariance, i.e. depend on both Wigner coordinates: momentum and coordinate.</p>
<p>In the limit of small frequency, i.e. <code>$\hslash\omega\ll\varepsilon$</code>, we obtain <code>$s_\alpha = s^\text{I}_\alpha+s^\text{II}_\alpha$</code>,</p>
<div>$$\begin{align}
    s^\text{I}_\alpha & =\frac{i\omega}{2\hslash}\int\frac{d\varepsilon}{2\pi}\int \frac{d^2\bb{p}}{(2\pi)^2}\Big(-\frac{\partial f}{\partial \varepsilon}\Big)\tr\big\langle
    2\sigma_\alpha G^\text{R}_{\varepsilon_+,\bb{p}_+} V_{\omega,\bb{q}} G^\text{A}_{\varepsilon_-,\bb{p}_-}
    \nonumber\\
     & \hspace{3cm}-\sigma_\alpha G^\text{A}_{\varepsilon_+,\bb{p}_+} V_{\omega,\bb{q}} G^\text{A}_{\varepsilon_-,\bb{p}_-} -\sigma_\alpha G^\text{R}_{\varepsilon_+,\bb{p}_+} V_{\omega,\bb{q}} G^\text{R}_{\varepsilon_-,\bb{p}_-}\big\rangle,\\
    s^\text{II}_\alpha & =\frac{i}{\hslash}\int\frac{d\varepsilon}{2\pi}\int \frac{d^2\bb{p}}{(2\pi)^2} f_\varepsilon \tr \big\langle\sigma_\alpha
    G^\text{A}_{\varepsilon_+,\bb{p}_+} V_{\omega,\bb{q}} G^\text{A}_{\varepsilon_-,\bb{p}_-}-
    \sigma_\alpha G^\text{R}_{\varepsilon_+,\bb{p}_+} V_{\omega,\bb{q}} G^\text{R}_{\varepsilon_-,\bb{p}_-}\big\rangle,
\end{align}$$</div>
<p>where <code>$s^{\text{I}}$</code> and <code>$s^\text{II}$</code> are the Kubo and Středa contributions respectively. The Středa contribution is sub-leading in the powers of weak disorder strength <code>$\alpha\ll 1$</code> as long as the Fermi energy lies outside the gap. Similarly, the AA and RR bubbles in the expression of <code>$s_\alpha^\text{I}$</code> are sub-leading and may be neglected. Furthermore, we work in the zero temperature limit.</p>
<p>The linear response to electric field and time derivative of magnetization corresponds to $V_{\bb{q},\omega} = -\hat{\bb{j}}
\cdot\bb{A}-\Delta_\text{sd} \bb{m}\cdot\bb{\sigma}$, so that we obtain</p>
<div>$$\begin{equation}
  \bb{s}_{\bb{q},\omega}=\frac{1}{v^2h}\hat{K}(\bb{q},\omega)[ev(\bb{E}_{\bb{q},\omega}\times\hat{\bb{z}})-i\omega\Delta_{\text{sd}}\bb{m}_{\omega}],
  \label{chap1:eq:skubo}
\end{equation}$$</div>
<p>where the components of the tensor <code>$\hat{K}$</code> are given by</p>
<div>$$\begin{equation}
\hat{K}_{\alpha\beta}(\bb{q},\omega)={v^2}\int\!\frac{d^2\bb{p}}{(2\pi)^2}\tr \langle \sigma_\alpha G^\text{R}_{\bb{p}+ \hslash q,\varepsilon+\hslash\omega}\sigma_\beta G^\text{A}_{\bb{p},\varepsilon}\rangle.
\label{chap1:eq:skuboB}
\end{equation}$$</div>

      </div></div>

  

  
  

  
</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2023 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="https://rsokolewicz.github.io/assets/main.js"></script>
<script src="https://rsokolewicz.github.io/assets/prism.js"></script>







  
</div>

</body>
</html>
